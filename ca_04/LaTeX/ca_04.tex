\input{preamble} 
\usepackage{mcode}

\begin{document}
\maketitle % Print the title

\section{Problem Statement} 
%Summarize the problem statement in one paragraph. Clearly state what the knowns are and what unknowns you must find.
This assignment introduced modeling real world distributions in MATLAB through the normal distribution, and expands to representing the data with other distributions. This was accomplished through the three tasks below:
\begin{enumerate}
\item Compute a histogram of the amplitude of the data and normalize it by the number of samples so that it is an estimate of the pdf.
\item Fit this distribution by estimating the mean and variance. Plot the Gaussian model on top of the histogram. Compare and contrast the quality of the fits to the data.
\item In (2), you should find that the Gaussian model is not a good fit for the Google data. Select another distribution from Chapter 4 that provides a better estimate of the data. Plot this model on the same graph with the histogram and the Gaussian fit. Compute the mean-squared error between the actual data and the parametric fit. Which gives a better approximation? (Do this for both data sets.)
\end{enumerate}


\section{Approach and Results} 
%Describe your approach to finding the unknowns. Use numbered figures, tables and equations where necessary.
\subsection*{Task 1} 
A histogram for each data set was generated through the MATLAB command \verb|histogram| with arguments to automatically normalize the distribution. This could also be accomplished by dividing the amplitude of each bin via the total number of bins in the histogram. 
\subsection*{Task 2}
The mean and variance of each data set was calculated. The parameters were then substituted into the normal distribution, equation~\ref{eq: normal}. The normal distribution was then graphed over of the histogram of each data set. 
\begin{equation}
f(x, \mu, \sigma) = \frac{1}{\sigma\sqrt{2\pi}}e^{\frac{(x-\mu)^2}{2\sigma^2}}
\label{eq: normal}
\end{equation}
\subsection*{Task 3} 
In the search for a better fitting distribution, each data set was loaded into the MATLAB's \verb|dfittool|. The \verb|dfittool| allows the user to quickly produce a variety of distributions to a data set. Through this tool the lognormal distribution was selected for Google data set.  The lognormal distribution, also known as the Galton distribution after Francis Galton, is display in equation~\ref{eq: lognormal}. \footnote{http://en.wikipedia.org/wiki/Log-normal\_distribution}
\begin{equation}
f(x, \mu, \sigma) = \frac{1}{x\sigma\sqrt{2\pi}}e^{\frac{(\ln{x}-\mu)^2}{2\sigma^2}}
\label{eq: lognormal}
\end{equation}
The distribution was then plotted over the histogram and normal distribution for the Google data set. The t Location-Scale distribution was selected as the distribution for the audio signal. The distribution is described below in equation~\ref{eq: tscale} where $v$ is shape parameter and greater than 0.\footnote{http://www.mathworks.com/help/stats/t-location-scale-distribution.html?refresh=true} The distribution was plotted over the histogram and the normal distribution of for the data set. The plots of the histogram, the normal distribution and the alternative distribution can be seen for the audio signal and the stock price in figures~\ref{fig: audio_plot} and \ref{fig: google_plot} respectively. 
\begin{equation}
f(x, \mu, \sigma, v) = \frac{\Gamma \left(\frac{v+1}{2}\right)}{\sigma\sqrt{v\pi}\Gamma(v/2)}\left[\frac{v + \left( \frac{x - \mu}{\sigma} \right)^2}{v} \right]^{-\left(\frac{v+1}{2}\right)}
\label{eq: tscale}
\end{equation}
 

\begin{figure}[H] % audio plot
	\centering 
	\includegraphics[width=\linewidth]{audio_plot}
	\caption{Histogram plot of audio signal (grey) with normal distribution (red) and t-Location-Scale distribution (orange).}
	\label{fig: audio_plot} 
\end{figure}

\begin{figure}[H] % google plot  
	\centering 
	\includegraphics[width=\linewidth]{google_plot}
	\caption{Histogram plot of google signal (grey) with normal distribution (red) and log-normal distribution (orange).}
	\label{fig: google_plot} 
\end{figure}

The mean squared error (MSE) was calculated between the histogram and the two distributions for each data set. The MSE error is described below where $PMF_X$ is the histogram and $f_X$ a parametrized distribution. The results are displayed in the table below. 
\begin{equation}
MSE = E\left[(PMF_X - f_X)^2\right]
\end{equation}
% Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[htbp]
  \centering
    \begin{tabular}{cccc}
    \toprule
    \multicolumn{2}{c}{Audio Signal  } & \multicolumn{2}{c}{Stock Price} \\
    \midrule
    Normal: & 5.82E-09 & Normal:  & 2.16E-08 \\
    t Location-Scale:  & 9.43E-09 & Lognormal: & 1.94E-09 \\
    \bottomrule
    \end{tabular}%
  \caption{MSE values for distributions trialed against each histogram.}
  \label{tab: tab1}%
\end{table}%


\section{MATLAB Code} 
%Show and briefly explain your MATLAB code.
\lstinputlisting[frame=single, caption='MATLAB solution for CA: 04.']{../MATLAB/ca_04.m}

\section{Conclusions} 
%Summarize what you found.
While there exists a collection of parametrized distributions, real data rarely conforms to the mold. This is reflected in both data sets. The histogram of the Google data set is particularly sporadic as it is a time-series with an increasing diversity for each sample. The audio signal is also a time-series, but with a constant predetermined range of samples.  \\

Reducing the MSE with the selected distributions was surprisingly troubling. For the audio signal, the t Location-Scale was actually considerably worst increasing the MSE by 61\%. This was surprising, as I initially thought the distribution's higher peak around the mean would reduce error substantially despite the distribution's lack of width compared to the PMF or normal distribution. If anything, this proves the need for criteria such as the MSE. The log-normal distribution reduced the MSE compared to the normal distribution by 10\%. 

\end{document}